notifications:
  email:
    recipients:
      - chris+travis@chrisdown.name
    on_success: never
    on_failure: always

before_install:
    - sudo add-apt-repository ppa:techzilla/misc -y
    - sudo apt-get update -q
install:
    - sudo apt-get install linkchecker
    - sudo apt-get install tidy --force-yes
    - bundle install
before_script:
    - 'tidy -v'
    - "jekyll serve --port 24895 &"
    - sleep 5
script:
    - linkchecker --no-warnings http://localhost:24895
    - "! find deploy/ -name '*.html' -exec tidy -e {} + 2>&1 | grep '[1-9] error'"
